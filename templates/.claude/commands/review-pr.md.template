---
name: review-pr
description: Critically review a pull request and provide feedback
version: 1.1.0
---

# /review-pr

Critically review a pull request, displaying a structured checklist, CI status, and PR details to guide thorough code review. Automatically detects if you're the PR author and suggests appropriate actions.

## Usage

```bash
/review-pr <pr-number>                    # Review without action
/review-pr <pr-number> --approve          # Review and approve (reviewers)
/review-pr <pr-number> --merge            # Merge the PR (authors)
/review-pr <pr-number> --checks           # Show detailed CI status
/review-pr --pending                      # List PRs needing your review
```

## Options

| Option | Description |
|--------|-------------|
| `--approve`, `-a` | Submit approving review (reviewers only) |
| `--request-changes`, `-x` | Submit review requesting changes |
| `--comment`, `-c` | Submit review as comment only |
| `--merge`, `-m` | Merge the PR (authors, or after approval) |
| `--checks` | Show detailed CI/check status |
| `--pending` | List all PRs needing your review |
| `--add-label <label>` | Add label after review |
| `--verbose`, `-v` | Show detailed output |
| `--project <path>` | Target project path |
| `--repo <owner/name>` | Target repository |

## What It Does

1. **Detects your role** - Author vs reviewer (smart action suggestions)
2. **Fetches PR metadata** - Title, author, branch, changes, reviews
3. **Shows CI/check status** - Pass/fail/pending with summary
4. **Shows files changed** - List of modified files
5. **Displays review checklist** - Structured areas to review
6. **Shows diff preview** - First 100 lines of changes
7. **Submits action** - Approve, request changes, comment, or merge

## Author Detection

The skill detects if you're the PR author and adjusts available actions:

**If you're the author:**
- `--approve` is blocked (can't self-approve)
- `--merge` is available (squash and delete branch)
- Shows merge readiness based on review status

**If you're a reviewer:**
- `--approve`, `--request-changes`, `--comment` available
- `--merge` still available if you have permissions

## CI/Check Status

The skill shows CI status in the PR summary:

```
Checks:   ✓ All 5 checks passed
Checks:   ○ 2 pending, 3 passed
Checks:   ✗ 1 failed, 4 passed, 1 pending
```

Use `--checks` for detailed breakdown:

```bash
/review-pr 42 --checks
```

Output:
```
CI/Check Details
========================================

  ✓ build
  ✓ test
  ✗ lint
  ○ deploy (pending)
```

## Pending Mode

List all PRs needing your review (excludes your own PRs):

```bash
/review-pr --pending
```

Output:
```
PRs Needing Review
========================================

  #42: Add authentication feature
      Author: teammate | Status: PENDING | Checks: ✓
  #45: Fix database connection
      Author: contributor | Status: PENDING | Checks: ○

Review a specific PR:
  /review-pr <number>
```

## Review Checklist

The skill guides you through reviewing:

### 1. Runtime Stability
- Exception and error handling
- Null/undefined checks
- Resource cleanup

### 2. Performance
- N+1 query patterns
- Algorithm efficiency
- Memory usage

### 3. Security
- Input validation
- Injection vulnerabilities (SQL, XSS)
- Authentication/authorization
- Secrets exposure

### 4. Test Coverage
- Unit tests for new logic
- Integration tests
- Edge cases

### 5. Code Quality
- Project patterns followed
- Clear naming and docs
- No dead code or debug statements

### 6. Breaking Changes
- API compatibility
- Database migrations
- Configuration changes

## Workflow Integration

### As a Reviewer

```bash
# 1. Find PRs needing review
/review-pr --pending

# 2. Review a specific PR
/review-pr 42

# 3. Check CI status if needed
/review-pr 42 --checks

# 4. Approve or request changes
/review-pr 42 --approve --add-label ready-to-merge
```

### As a PR Author

```bash
# 1. Check your PR status
/review-pr 42

# 2. After approval, merge
/review-pr 42 --merge
```

## Examples

### View PR for Review
```bash
/review-pr 42
```

Output includes:
- PR summary (title, author, changes)
- CI/check status (pass/fail/pending)
- Your role indicator (author/reviewer)
- Files changed
- Review checklist
- Diff preview
- Context-aware next steps

### Merge Your PR (Authors)
```bash
/review-pr 42 --merge
```

Merges using squash strategy and deletes the branch. Warns if:
- CI checks failed or pending
- Merge conflicts exist

### Approve PR (Reviewers)
```bash
/review-pr 42 --approve
```

Submits an approving review. Blocked if you're the author.

## Requirements

- `gh` - GitHub CLI, authenticated
- `jq` - JSON processor

## Related Skills

| Skill | Relationship |
|-------|--------------|
| `/check-reviews` | Find PRs needing review |
| `/address-review` | Address feedback on your PRs |
| `/submit-pr` | Create PRs for review |

## Tips

### For Thorough Reviews

1. **Read the PR description first** - Understand intent
2. **Check CI status** - Use `--checks` for details
3. **Review file by file** - Use `gh pr diff` for full diff
4. **Consider edge cases** - What could go wrong?
5. **Check for security issues** - Especially with user input

### Review Comment Best Practices

- Be specific and actionable
- Suggest solutions, not just problems
- Distinguish blocking issues from nits
- Acknowledge good patterns you see
